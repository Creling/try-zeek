{"sources": [{"content": "global ssh_connections: count = 0;\nglobal ssh_connections_by_host: table[addr] of count &default=0;\n\nevent SSH::log_ssh(rec: SSH::Info) {\n    ++ssh_connections;\n    ++ssh_connections_by_host[rec$id$orig_h];\n}\n\nevent bro_done() {\n    print fmt(\"Saw %d ssh connections\", ssh_connections);\n    for (src in ssh_connections_by_host) {\n        print fmt(\"%s made %d connections\", src, ssh_connections_by_host[src]);\n    }\n}\n", "name": "main.bro"}]}